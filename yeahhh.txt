-- Roblox å‚³é€è¼”åŠ©å®Œæ•´è…³æœ¬ï¼ˆè¡Œå‹•è£ç½®å°ˆç”¨ï¼‰
local Players = game:GetService("Players")
local RunService = game:GetService("RunService")
local localPlayer = Players.LocalPlayer

local allPlayers = {}
local selectedPlayer = nil
local currentIndex = 1
local longTeleporting = false

-- å»ºç«‹ GUI
local screenGui = Instance.new("ScreenGui", localPlayer:WaitForChild("PlayerGui"))
screenGui.Name = "TeleportUI"
screenGui.ResetOnSpawn = false

-- ğŸ§± å‡½æ•¸ï¼šå»ºç«‹åœ“è§’
local function makeRounded(uiElement, radius)
	local corner = Instance.new("UICorner")
	corner.CornerRadius = UDim.new(0, radius or 8)
	corner.Parent = uiElement
end

-- ğŸ“¦ å‚³é€æŒ‰éˆ•ï¼ˆé»ƒè‰²ï¼‰
local toggleButton = Instance.new("TextButton", screenGui)
toggleButton.Text = "å‚³é€"
toggleButton.BackgroundColor3 = Color3.fromRGB(255, 255, 0)
toggleButton.Size = UDim2.new(0, 100, 0, 40)
toggleButton.Position = UDim2.new(0, 100, 0, 100)
toggleButton.TextScaled = true
toggleButton.Active = true
toggleButton.Draggable = true
makeRounded(toggleButton)

-- ğŸ“¦ ä¸»é¢æ¿
local panelFrame = Instance.new("Frame", screenGui)
panelFrame.Size = UDim2.new(0, 250, 0, 120)
panelFrame.Position = UDim2.new(0, 100, 0, 150)
panelFrame.BackgroundColor3 = Color3.fromRGB(30, 30, 30)
panelFrame.Visible = false
panelFrame.Active = true
panelFrame.Draggable = true
makeRounded(panelFrame)

-- â¬…ï¸ å·¦ç®­é ­
local leftButton = Instance.new("TextButton", panelFrame)
leftButton.Text = "<"
leftButton.Size = UDim2.new(0, 30, 0, 40)
leftButton.Position = UDim2.new(0, 10, 0, 10)
leftButton.BackgroundColor3 = Color3.fromRGB(150, 150, 150)
leftButton.TextScaled = true
makeRounded(leftButton)

-- ğŸ‘¤ ç©å®¶åç¨±
local playerNameLabel = Instance.new("TextButton", panelFrame)
playerNameLabel.Text = "ç©å®¶åç¨±"
playerNameLabel.Size = UDim2.new(0, 170, 0, 40)
playerNameLabel.Position = UDim2.new(0, 40, 0, 10)
playerNameLabel.BackgroundColor3 = Color3.fromRGB(80, 80, 80)
playerNameLabel.TextScaled = true
makeRounded(playerNameLabel)

-- â¡ï¸ å³ç®­é ­
local rightButton = Instance.new("TextButton", panelFrame)
rightButton.Text = ">"
rightButton.Size = UDim2.new(0, 30, 0, 40)
rightButton.Position = UDim2.new(0, 215, 0, 10)
rightButton.BackgroundColor3 = Color3.fromRGB(150, 150, 150)
rightButton.TextScaled = true
makeRounded(rightButton)

-- ğŸ”µ é»å‚³é€
local pointButton = Instance.new("TextButton", panelFrame)
pointButton.Text = "é»"
pointButton.Size = UDim2.new(0.5, -5, 0, 40)
pointButton.Position = UDim2.new(0, 10, 0, 65)
pointButton.BackgroundColor3 = Color3.fromRGB(0, 170, 255)
pointButton.TextScaled = true
makeRounded(pointButton)

-- ğŸ”´ é•·å‚³é€
local longButton = Instance.new("TextButton", panelFrame)
longButton.Text = "é•·"
longButton.Size = UDim2.new(0.5, -5, 0, 40)
longButton.Position = UDim2.new(0.5, 5, 0, 65)
longButton.BackgroundColor3 = Color3.fromRGB(255, 70, 70)
longButton.TextScaled = true
makeRounded(longButton)

-- ğŸ“‹ æ›´æ–°ç©å®¶åˆ—è¡¨
local function updatePlayerList()
	allPlayers = {}
	for _, player in ipairs(Players:GetPlayers()) do
		if player ~= localPlayer then
			table.insert(allPlayers, player)
		end
	end
	if #allPlayers > 0 then
		currentIndex = math.clamp(currentIndex, 1, #allPlayers)
		selectedPlayer = allPlayers[currentIndex]
		playerNameLabel.Text = selectedPlayer.Name
	else
		selectedPlayer = nil
		playerNameLabel.Text = "ç„¡å…¶ä»–ç©å®¶"
	end
end

-- â›” åœæ­¢é•·å‚³é€
local function stopLongTeleport()
	longTeleporting = false
end

-- ğŸ§­ å‚³é€åˆ°ç©å®¶å‰æ–¹ï¼ˆæ ¹æ“šç§»å‹•æ–¹å‘ Velocityï¼‰
local function teleportToFront()
	if not selectedPlayer or not selectedPlayer.Character then return end
	local targetHRP = selectedPlayer.Character:FindFirstChild("HumanoidRootPart")
	if not targetHRP then return end

	local velocity = targetHRP.Velocity
	local direction = (velocity.Magnitude > 1) and velocity.Unit or targetHRP.CFrame.LookVector
	local frontPos = targetHRP.Position + (direction * 2.5)

	local myChar = localPlayer.Character
	if myChar and myChar:FindFirstChild("HumanoidRootPart") then
		myChar:MoveTo(frontPos)
	end
end

-- ğŸŒ€ æŒçºŒå‚³é€æ¯å¹€åˆ·æ–°
RunService.RenderStepped:Connect(function()
	if longTeleporting and selectedPlayer then
		teleportToFront()
	end
end)

-- ğŸ”˜ æ§åˆ¶é‚è¼¯
toggleButton.MouseButton1Click:Connect(function()
	panelFrame.Visible = not panelFrame.Visible
	stopLongTeleport()
	updatePlayerList()
end)

leftButton.MouseButton1Click:Connect(function()
	updatePlayerList()
	if #allPlayers > 0 then
		currentIndex = (currentIndex - 2) % #allPlayers + 1
		selectedPlayer = allPlayers[currentIndex]
		playerNameLabel.Text = selectedPlayer.Name
	end
	stopLongTeleport()
end)

rightButton.MouseButton1Click:Connect(function()
	updatePlayerList()
	if #allPlayers > 0 then
		currentIndex = (currentIndex) % #allPlayers + 1
		selectedPlayer = allPlayers[currentIndex]
		playerNameLabel.Text = selectedPlayer.Name
	end
	stopLongTeleport()
end)

playerNameLabel.MouseButton1Click:Connect(function()
	updatePlayerList()
	if selectedPlayer then
		teleportToFront()
		stopLongTeleport()
	end
end)

pointButton.MouseButton1Click:Connect(function()
	updatePlayerList()
	if selectedPlayer then
		teleportToFront()
		stopLongTeleport()
	end
end)

longButton.MouseButton1Click:Connect(function()
	updatePlayerList()
	if selectedPlayer then
		longTeleporting = true
	end
end)

-- ğŸ¯ è‡ªå‹•æ›´æ–°
Players.PlayerAdded:Connect(function()
	task.wait(0.5)
	updatePlayerList()
end)

Players.PlayerRemoving:Connect(function()
	task.wait(0.5)
	updatePlayerList()
end)

localPlayer.CharacterAdded:Connect(function()
	task.wait(1)
	updatePlayerList()
end)

-- åˆå§‹åŒ–
updatePlayerList()